# Password Reset —á–µ—Ä–µ–∑ Resend.com ‚úÖ

## üéØ –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

**–†–∞–Ω—å—à–µ:** Supabase Auth –æ—Ç–ø—Ä–∞–≤–ª—è–ª magic links –¥–ª—è —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è
**–°–µ–π—á–∞—Å:** Resend.com –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç 6-–∑–Ω–∞—á–Ω—ã–µ –∫–æ–¥—ã (–∫–∞–∫ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏)

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. SQL –º–∏–≥—Ä–∞—Ü–∏—è
```sql
-- –í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ Supabase SQL Editor
-- –§–∞–π–ª: database/password_reset_codes.sql
```

### 2. –î–µ–ø–ª–æ–π Edge Functions
```bash
./deploy-password-reset.sh
```

### 3. –û—Ç–∫–ª—é—á–∏—Ç–µ Supabase Email
–°–º. `DISABLE_SUPABASE_EMAIL.md`

### 4. –î–µ–ø–ª–æ–π –Ω–∞ Vercel
–°–º. `VERCEL_DEPLOYMENT.md`

---

## üìÅ –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã

### Backend
- `database/password_reset_codes.sql` - —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è –∫–æ–¥–æ–≤
- `supabase/functions/send-password-reset-email/` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ resend.com
- `supabase/functions/update-password/` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è

### Frontend
- `src/utils/passwordReset.ts` - —É—Ç–∏–ª–∏—Ç—ã
- `src/views/VerifyResetCodePage.vue` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤–≤–æ–¥–∞ –∫–æ–¥–∞
- `src/components/auth/ResetCodeInput.vue` - UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `PASSWORD_RESET_QUICKSTART.md` - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (5 –º–∏–Ω)
- `PASSWORD_RESET_DEPLOYMENT.md` - –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- `DISABLE_SUPABASE_EMAIL.md` - –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ Supabase
- `VERCEL_DEPLOYMENT.md` - –¥–µ–ø–ª–æ–π –Ω–∞ Vercel
- `ENVIRONMENT_VARIABLES.md` - –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `deploy-password-reset.sh` - —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–¥–µ–ø–ª–æ—è
- `test-password-reset.http` - –ø—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üîÑ –ù–æ–≤—ã–π —Ñ–ª–æ—É

```
1. /reset-password ‚Üí –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç email
2. Backend ‚Üí –°–æ–∑–¥–∞–µ—Ç—Å—è 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥
3. Resend.com ‚Üí –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫—Ä–∞—Å–∏–≤–æ–µ –ø–∏—Å—å–º–æ
4. /auth/verify-reset-code ‚Üí –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –∫–æ–¥
5. /auth/update-password ‚Üí –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å
```

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

| –ë—ã–ª–æ | –°—Ç–∞–ª–æ |
|------|-------|
| ‚ùå Magic links | ‚úÖ 6-–∑–Ω–∞—á–Ω—ã–µ –∫–æ–¥—ã |
| ‚ùå Supabase email | ‚úÖ Resend.com |
| ‚ùå –ë–∞–∑–æ–≤—ã–µ –ø–∏—Å—å–º–∞ | ‚úÖ –ö—Ä–∞—Å–∏–≤—ã–π HTML |
| ‚ùå –†–∞–∑–Ω—ã–π UX | ‚úÖ –ï–¥–∏–Ω—ã–π —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π |

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

| –î–æ–∫—É–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `PASSWORD_RESET_QUICKSTART.md` | üìò –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –∑–∞ 5 –º–∏–Ω—É—Ç |
| `PASSWORD_RESET_DEPLOYMENT.md` | üìó –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–µ–ø–ª–æ—é |
| `DISABLE_SUPABASE_EMAIL.md` | üîß –ö–∞–∫ –æ—Ç–∫–ª—é—á–∏—Ç—å Supabase email |
| `VERCEL_DEPLOYMENT.md` | üöÄ –î–µ–ø–ª–æ–π –Ω–∞ Vercel |
| `ENVIRONMENT_VARIABLES.md` | üîê –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è |
| `test-password-reset.http` | üß™ –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è |

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –ö–æ–¥—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã 15 –º–∏–Ω—É—Ç
- ‚úÖ –ú–∞–∫—Å–∏–º—É–º 3 –ø–æ–ø—ã—Ç–∫–∏ –≤–≤–æ–¥–∞
- ‚úÖ RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –∑–∞—â–∏—â–∞—é—Ç –¥–∞–Ω–Ω—ã–µ
- ‚úÖ Edge Functions –∏—Å–ø–æ–ª—å–∑—É—é—Ç Service Role Key
- ‚úÖ Rate limiting –≤ Resend

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–æ (—Å VITE_DISABLE_EMAIL=true)
–ö–æ–¥ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞

### Production
1. –û—Ç–∫—Ä–æ–π—Ç–µ `/reset-password`
2. –í–≤–µ–¥–∏—Ç–µ email
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∏—Å—å–º–æ –æ—Ç `noreply@tourfurr.camp`
4. –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥
5. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
# –õ–æ–≥–∏ Edge Functions
supabase functions logs send-password-reset-email --tail

# –ê–∫—Ç–∏–≤–Ω—ã–µ –∫–æ–¥—ã
SELECT * FROM password_reset_codes
WHERE used = false AND expires_at > NOW();
```

**Resend Dashboard:** https://resend.com/emails

---

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

**–ü–∏—Å—å–º–∞ –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç?**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `RESEND_API_KEY` –≤ Supabase secrets
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–º–µ–Ω –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –≤ Resend
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Edge Functions

**–û—à–∏–±–∫–∞ "User not found"?**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Ç–∞–±–ª–∏—Ü–µ `users`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á–µ—Ä–µ–∑ Supabase Dashboard

**–ù–µ —É–¥–∞–µ—Ç—Å—è –æ–±–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å?**
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∫–æ–¥ –±—ã–ª –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ sessionStorage (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `reset_email`)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ `update-password` —Ñ—É–Ω–∫—Ü–∏–∏

---

## ‚ö° –ö–æ–º–∞–Ω–¥—ã

```bash
# –î–µ–ø–ª–æ–π –≤—Å–µ–≥–æ —Å—Ä–∞–∑—É
./deploy-password-reset.sh

# –û—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
supabase functions deploy send-password-reset-email
supabase functions deploy update-password

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤
supabase secrets list

# –õ–æ–≥–∏
supabase functions logs send-password-reset-email --tail
```

---

## ‚ú® –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
- ‚úÖ **–¢–æ–ª—å–∫–æ resend.com** –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–∏—Å—å–º–∞
- ‚úÖ Supabase Auth –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–µ–Ω –¥–ª—è password reset
- ‚úÖ –ö—Ä–∞—Å–∏–≤—ã–µ –±—Ä–µ–Ω–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∏—Å—å–º–∞
- ‚úÖ –ï–¥–∏–Ω—ã–π UX —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π
- ‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –ø—Ä–æ—Ü–µ—Å—Å–æ–º

**–í—Å–µ –≥–æ—Ç–æ–≤–æ –∫ production! üéâ**
